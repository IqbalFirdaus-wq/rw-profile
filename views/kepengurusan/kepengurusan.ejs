<div class="d-flex justify-content-between mb-3">
  <h1 class="h4">Daftar Pengurus RW</h1>

  <div class="d-flex gap-2">
    <!-- ðŸ”½ Dropdown Filter RW -->
    <form method="get" action="/kepengurusan" class="d-flex align-items-center">
      <div class="input-group" style="max-width: 250px;">
        <label class="input-group-text" for="rwSelect">RW</label>
        <select id="rwSelect" name="kode_rw" class="form-select"
                onchange="if(this.value) location.href='/kepengurusan/'+this.value; else location.href='/kepengurusan'">
          <option value="">Semua RW</option>
          <% allRw.forEach(rwOption => { %>
            <option value="<%= rwOption.id %>"
              <%= rw_id && String(rwOption.id) === String(rw_id) ? 'selected' : '' %>>
              RW <%= rwOption.kode_rw %> - <%= rwOption.nama_rw %>
            </option>
          <% }) %>
        </select>
      </div>
    </form>
  
    <!-- âœ… Export Excel -->
    <a href="/kepengurusan/<%= rw_id ? rw_id : '' %>/export"
       class="btn btn-success btn-sm">
       Export Excel
    </a>
  
    <!-- âœ… Tambah Pengurus selalu aktif -->
    <a href="/kepengurusan/add" class="btn btn-primary">
      Tambah Pengurus
    </a>    
  </div>    
</div>

<table class="table table-striped table-bordered bg-white shadow-sm">
  <thead class="table-success">
    <tr>
      <th><a href="?rw=<%= rw_id || '' %>&sort=kode_rw&order=<%= sort==='kode_rw' && order==='ASC' ? 'DESC':'ASC' %>">
            RW
            <% if (sort==='kode_rw'){ %><%= order==='ASC'?'â–²':'â–¼' %><% } %>
          </a></th>
      <th>Nama</th>
      <th>Jabatan</th>
      <th>No KTP</th>
      <th>Telepon</th>
      <th>Alamat</th>
      <th>Aksi</th>
    </tr>
  </thead>
  <tbody>
    <% if (pengurus.length) { %>
      <% pengurus.forEach(p => { %>
        <tr>
          <td><%= p.rw_id %></td>
          <td><%= p.nama %></td>
          <td><%= p.jabatan %></td>
          <td><%= p.no_ktp %></td>
          <td><%= p.telp %></td>
          <td><%= p.alamat %></td>
          <td>
            <a href="/kepengurusan/<%= rw_id || p.rw_id %>/<%= p.id %>/edit"
               class="btn btn-warning btn-sm">Edit</a>
          
            <form action="/kepengurusan/<%= rw_id || p.rw_id %>/<%= p.id %>/delete"
                  method="post" class="d-inline"
                  onsubmit="return confirm('Hapus pengurus ini?');">
              <button class="btn btn-danger btn-sm">Hapus</button>
            </form>
          </td>          
        </tr>
      <% }) %>
    <% } else { %>
      <tr>
        <td colspan="7" class="text-center text-muted">Tidak ada data pengurus</td>
      </tr>
    <% } %>
  </tbody>
</table>
